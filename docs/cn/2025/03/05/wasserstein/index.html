<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Wasserstein距离与经验分布 - Tan Jay | 唐 洁</title>
    <meta property="og:title" content="Wasserstein距离与经验分布 - Tan Jay | 唐 洁">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="在统计学与机器学习中，经验分布与Wasserstein距离的关系可以通过以下直观解释和具体应用来理解：
[&amp;hellip;] 分布鲁棒优化（DRO）：
在DRO中，通常构建一个以经验分布 \(P_n\) 为中心、半径为 \(\epsilon\) 的 Wasserstein 球作为不确定性集合： $ \mathcal{U}_\epsilon(P_n) = \{ Q \mid W_p(Q, P_n) &amp;hellip;">
      <meta property="og:description" content="在统计学与机器学习中，经验分布与Wasserstein距离的关系可以通过以下直观解释和具体应用来理解：
[&amp;hellip;] 分布鲁棒优化（DRO）：
在DRO中，通常构建一个以经验分布 \(P_n\) 为中心、半径为 \(\epsilon\) 的 Wasserstein 球作为不确定性集合： $ \mathcal{U}_\epsilon(P_n) = \{ Q \mid W_p(Q, P_n) &amp;hellip;">
      
    

    
    
    
    <meta name="twitter:image" content="/images/logo.png">
    
    

    

    
    

    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    
<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/load-typekit.min.js" defer></script>








<link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="cn">
    <header class="masthead">
      

<h1><a href="/"><img src="/images/logo.png" alt="Tan Jay" /></a></h1>



      <nav class="menu">
  <ul>
  
  
  <li><a href="/">主页</a></li>
  
  <li><a href="/resume/">简历</a></li>
  
  <li><a href="/cn/">日志</a></li>
  
  <li><a href="/categories/">目录</a></li>
  
  <li><a href="/tags/">标签</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Wasserstein距离与经验分布</h1>


<h3>Tan Jay / 
2025-03-05</h3>

<hr>


      </header>





<p>在统计学与机器学习中，<strong>经验分布</strong>与<strong>Wasserstein距离</strong>的关系可以通过以下直观解释和具体应用来理解：</p>
<h3 id="1-经验分布-empirical-distribution"><strong>1. 经验分布（Empirical Distribution）</strong></h3>
<ul>
<li><strong>定义</strong>：经验分布是由观测数据直接构造的离散概率分布。假设有 \(n\) 个独立样本 \(X_1, X_2, \dots, X_n\)，经验分布 \(P_n\) 为每个样本点赋予均等的概率质量 \(1/n\)，即：
\[
P_n = \frac{1}{n} \sum_{i=1}^n \delta_{X_i},
\]
其中 \(\delta_{X_i}\) 是位于样本点 \(X_i\) 的狄拉克函数（Dirac delta）。</li>
<li><strong>作用</strong>：经验分布是对真实数据生成分布 \(P\) 的非参数估计，直接基于样本信息。</li>
</ul>
<h3 id="2-wasserstein距离-wasserstein-distance"><strong>2. Wasserstein距离（Wasserstein Distance）</strong></h3>
<ul>
<li><strong>定义</strong>：Wasserstein距离（也称为推土机距离）是衡量两个概率分布之间差异的度量，其核心思想是“以最小成本将一个分布转化为另一个分布”。对于两个分布 \(P\) 和 \(Q\)，其 \(p\)-阶 Wasserstein距离定义为：
\[
W_p(P, Q) = \left( \inf_{\gamma \in \Gamma(P, Q)} \int |x - y|^p , d\gamma(x, y) \right)^{1/p},
\]
其中 \(\Gamma(P, Q)\) 是 \(P\) 和 \(Q\) 的所有联合分布（称为运输计划），\(|x - y|\) 是点 \(x\) 和 \(y\) 之间的几何距离。</li>
<li><strong>特点</strong>：
<ul>
<li><strong>几何敏感性</strong>：Wasserstein距离考虑数据空间的几何结构（如欧氏距离），适合处理分布间的空间差异。</li>
<li><strong>对低支撑分布友好</strong>：即使两个分布的支撑集不重叠，仍能有效度量差异（与KL散度不同）。</li>
</ul>
</li>
</ul>
<h3 id="3-经验分布与wasserstein距离的关系"><strong>3. 经验分布与Wasserstein距离的关系</strong></h3>
<h4 id="1-投影问题-projection"><strong>(1) 投影问题（Projection）</strong></h4>
<ul>
<li><strong>核心思想</strong>：将经验分布 \(P_n\) 投影到一个特定的分布集合 \(\mathcal{Q}\)（例如满足某种约束的分布流形），并计算投影后的 Wasserstein 距离。</li>
<li><strong>数学形式</strong>：<br>
假设 \(\mathcal{Q}\) 是某个模型假设下的分布集合（如参数模型或满足矩条件的分布），投影问题可以表示为：
\[
\inf_{Q \in \mathcal{Q}} W_p(P_n, Q).
\]
这一过程旨在找到与经验分布 \(P_n\) 最接近（在Wasserstein意义下）的分布 \(Q \in \mathcal{Q}\)。</li>
</ul>
<h4 id="2-统计推断中的应用"><strong>(2) 统计推断中的应用</strong></h4>
<ul>
<li>
<p><strong>分布鲁棒优化（DRO）</strong>：<br>
在DRO中，通常构建一个以经验分布 \(P_n\) 为中心、半径为 \(\epsilon\) 的 Wasserstein 球作为不确定性集合：
<code>$ \mathcal{U}_\epsilon(P_n) = \{ Q \mid W_p(Q, P_n) \leq \epsilon \} $</code>。
优化目标是最坏情况（Worst-Case）风险：
<code>$ \min_{\theta} \max_{Q \in \mathcal{U}_\epsilon (P_n)} \mathbb{E}_{Q}[\mathcal{L}(\theta; X)] $</code>。
这种方法的鲁棒性源于对分布偏移的直接建模。</p>
</li>
<li>
<p><strong>模型选择与假设检验</strong>：<br>
通过计算经验分布到某个假设分布类 \(\mathcal{Q}\) 的 Wasserstein 距离，可以评估模型假设的合理性。例如：</p>
<ul>
<li>若 \(W_p(P_n, \mathcal{Q})\) 较小，说明经验分布与假设模型 \(\mathcal{Q}\) 兼容；</li>
<li>若距离较大，则可能拒绝原假设（如数据不符合正态分布）。</li>
</ul>
</li>
</ul>
<h4 id="3-与kl散度投影的对比"><strong>(3) 与KL散度投影的对比</strong></h4>
<ul>
<li><strong>KL散度投影</strong>：最小化 \(KL(Q | P_n)\) 或 \(KL(P_n | Q)\)，倾向于匹配概率质量的比例，但对分布的几何结构不敏感。</li>
<li><strong>Wasserstein投影</strong>：最小化分布间的几何运输成本，适合需要保留数据空间关系的场景（如图像生成、空间数据分析）。</li>
</ul>
<h3 id="4-具体例子"><strong>4. 具体例子</strong></h3>
<h4 id="例1-鲁棒机器学习模型训练"><strong>例1：鲁棒机器学习模型训练</strong></h4>
<ul>
<li><strong>问题</strong>：训练一个分类器，使其对输入数据的分布偏移（如光照变化、噪声）具有鲁棒性。</li>
<li><strong>方法</strong>：使用 Wasserstein DRO，构建以训练数据经验分布 \(P_n\) 为中心的不确定性集合，优化模型在最坏情况分布下的性能。</li>
<li><strong>优势</strong>：模型在测试时遇到分布偏移（如噪声图像）时表现更稳定。</li>
</ul>
<h4 id="例2-生成对抗网络-gan"><strong>例2：生成对抗网络（GAN）</strong></h4>
<ul>
<li><strong>问题</strong>：生成器网络需要生成与真实数据分布接近的样本。</li>
<li><strong>方法</strong>：  在Wasserstein GAN (WGAN) 中，通过最小化生成分布 \(Q_\theta\) 与经验分布 \(P_n\) 之间的 Wasserstein 距离来训练生成器：
\[
\min_{\theta} W_1(Q_\theta, P_n).
\]</li>
<li><strong>优势</strong>：Wasserstein距离提供更平滑的优化梯度，避免模式崩溃（Mode Collapse）。</li>
</ul>
<h3 id="5-相关文献"><strong>5. 相关文献</strong></h3>
<ul>
<li>
<p>讨论基于似然比或KL散度的投影方法，而Wasserstein投影是另一种几何驱动的投影准则。</p>
<ul>
<li>Owen. <em>Empirical Likelihood</em>. Chapman and Hall/CRC, 2001</li>
</ul>
</li>
<li>
<p>将Wasserstein投影与DRO结合，证明在分布鲁棒优化中，使用Wasserstein距离构建不确定性集合可以提供更自然的鲁棒性保证（尤其是对协变量偏移）。</p>
<ul>
<li>
<p>John C Duchi, Peter W Glynn, and Hongseok Namkoong. <em>Statistics of robust optimization: A generalized empirical likelihood approach</em>. Accepted to Mathematics of Operations Research, 2021.</p>
</li>
<li>
<p>Henry Lam. <em>Recovering best statistical guarantees via the empirical divergence-based distributionally robust optimization</em>. Operations Research, 67(4):1090–1105, 2019.</p>
</li>
<li>
<p>Henry Lam and Enlu Zhou. <em>The empirical likelihood approach to quantifying uncertainty in sample average approximation</em>. Operations Research Letters, 45(4):301–307, 2017.</p>
</li>
</ul>
</li>
</ul>
<h3 id="总结"><strong>总结</strong></h3>
<ul>
<li><strong>经验分布</strong>是对真实分布的样本估计，而 <strong>Wasserstein距离</strong> 是衡量经验分布与目标分布之间差异的几何敏感度量。</li>
<li><strong>投影问题</strong>：通过最小化 Wasserstein 距离，将经验分布对齐到特定模型假设的分布集合，用于统计推断、假设检验或鲁棒优化。</li>
<li><strong>优势</strong>：相比于KL散度，Wasserstein距离更关注数据空间的几何结构，适合需要保留空间关系的场景（如图像、物理系统）。</li>
<li><strong>应用</strong>：在分布鲁棒优化、生成模型、非参数统计中均有核心作用。</li>
</ul>
<p>简言之，<strong>Wasserstein距离为经验分布提供了一种“几何镜头”</strong>，使其能够更自然地与复杂的数据分布和实际问题中的分布偏移相结合。</p>



  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/cn/2025/03/05/deepseekdro/">学习DRO路线图</a></span>
  <span class="nav-next"><a href="/cn/2025/03/05/deepseekoutline/">DRO大纲</a> &rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/cn\/2025\/03\/05\/deepseekdro\/';
    
  } else if (e.which == 39) {  
    
    url = '\/cn\/2025\/03\/05\/deepseekoutline\/';
    
  }
  if (url) window.location = url;
});
</script>







<script async src="https://cdn.jsdelivr.net/combine/npm/@xiee/utils/js/fix-toc.min.js,npm/@xiee/utils/js/center-img.min.js,npm/@xiee/utils/js/right-quote.min.js,npm/@xiee/utils/js/no-highlight.min.js,npm/@xiee/utils/js/fix-footnote.min.js,npm/@xiee/utils/js/math-code.min.js,npm/@xiee/utils/js/hash-notes.min.js,npm/@xiee/utils/js/external-link.min.js,npm/@xiee/utils/js/alt-title.min.js,npm/@xiee/utils/js/header-link.min.js"></script>







<script src="https://cdn.jsdelivr.net/npm/@xiee/utils/js/toggle-notes.min.js" defer></script>



<script async src="//mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>


  

  
  <hr>
  <div class="copyright">© Tan Jay 2022 ｜ <a href="mailto:tanjay@foxmail.com">tanjay@foxmail.com</a></div>
  
  </footer>
  </article>
  
  


  </body>
</html>

